<!-- void.html (FIXED + UPDATED)
  Fixes:
  ‚úÖ stream button id mismatch (app.js expects toNewestBtn; CSS uses .stream-top-btn; HTML had streamTopBtn)
  ‚úÖ add missing signalsUrlLabel text fallback
  ‚úÖ better accessibility: aria-hidden toggled when modals open/close (JS already handles class, but aria is set here)
  ‚úÖ puzzle payload is optional: keep it hidden visually but present for debugging (CSS can hide later)
  ‚úÖ consistent IDs with your current app.js:
     - toNewestBtn
     - menuDrop
     - openOnboarding / closeOnboarding
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Myrq Protocol: Ghost Signal</title>
  <meta name="description" content="You are a Signal Hunter. Scan, synthesize, and reconstruct the Master Manifest." />
  <link rel="icon" href="data:," />
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <canvas id="matrix" aria-hidden="true"></canvas>
  <div class="vignette" aria-hidden="true"></div>
  <div class="scanlines" aria-hidden="true"></div>

  <header class="topbar">
    <div class="brand">
      <span class="logo" aria-hidden="true">üúè</span>
      <div class="brand-text">
        <div class="brand-title">THE MYRQ PROTOCOL</div>
        <div class="brand-sub">GHOST SIGNAL // 2026</div>
      </div>
    </div>

    <div class="top-actions">
      <button id="scanBtn" class="chip" type="button">SCAN</button>
      <button id="soundToggle" class="chip" type="button">SOUND: OFF</button>

      <div class="menu">
        <button id="menuBtn" class="chip" type="button" aria-haspopup="true" aria-expanded="false">
          MENU ‚ñæ
        </button>
        <div id="menuDrop" class="menu-drop" role="menu" aria-label="Menu">
          <button class="menu-item" id="openOnboarding" type="button" role="menuitem">How it works</button>
          <button class="menu-item" id="genChallenge" type="button" role="menuitem">Generate challenge code</button>
          <button class="menu-item" id="clearProgress" type="button" role="menuitem">Reset progress</button>
        </div>
      </div>
    </div>
  </header>

  <main class="shell">
    <aside class="side">
      <div class="side-card">
        <div class="side-title">Signal Feed</div>
        <div class="side-text">
          Incoming fragments from Myrq‚Äôs breach. Click a signal to synthesize it.
        </div>

        <div class="meter">
          <div class="meter-head">
            <div class="meter-title">SYNCHRONICITY</div>
            <div class="meter-meta"><span id="syncPct">0</span>%</div>
          </div>
          <div class="meter-bar"><div id="syncFill" class="meter-fill"></div></div>
          <div class="meter-sub">
            No storage. Progress is read from URL flags:
            <code>?solved_0x100=1</code>
          </div>
        </div>

        <div id="signals" class="signals" aria-label="Signals list">
          <div class="side-text muted tiny" id="signalsHint">Press SCAN to load signals‚Ä¶</div>
        </div>

        <div class="side-text muted tiny">
          Source: <span id="signalsUrlLabel">./puzzles.master.json</span>
        </div>
      </div>

      <div class="side-card">
        <div class="side-title">Challenge Code</div>
        <div class="side-text">Invite another Signal Hunter.</div>

        <div class="row">
          <input id="challengeOut" class="pw" placeholder="code appears here" readonly />
          <button id="copyChallengeBtn" class="btn ghost small" type="button">COPY</button>
        </div>
      </div>
    </aside>

    <section class="panel" role="region" aria-label="Ghost Signal Terminal">
      <div class="panel-head">
        <div class="badge" id="phaseBadge">SCANNING</div>
        <h1 class="title glitch" data-text="GHOST SIGNAL">GHOST SIGNAL</h1>
        <p class="subtitle">
          You are a <b>Signal Hunter</b>. Reconstruct the <b>Master Manifest</b> by solving fragments.
        </p>
      </div>

      <div class="mission" id="mission">
        <div class="mission-title">WHAT TO DO</div>
        <ol class="mission-steps">
          <li>Press <b>SCAN</b> to fetch signals (JSON).</li>
          <li>Click a <b>Signal Card</b> ‚Üí <b>SYNTHESIZE</b> in RAM (Virtual Merger).</li>
          <li>Solve the puzzle ‚Üí URL gains <code>solved_*</code> flags ‚Üí Synchronicity rises.</li>
          <li>Each opened signal reveals a <b>Secret Fragment</b> in the terminal stream.</li>
        </ol>
      </div>

      <div class="controls">
        <div class="input-wrap">
          <label class="sr-only" for="keyInput">Key</label>
          <input
            id="keyInput"
            autocomplete="off"
            autocapitalize="characters"
            spellcheck="false"
            placeholder="type a vault key (0x...) or paste enc:v1 fragment to decrypt"
          />
        </div>
        <button id="unlockBtn" class="btn primary" type="button">
          <span class="dot"></span> UNLOCK
        </button>
      </div>

      <div class="actions">
        <button id="helpBtn" class="btn ghost" type="button">HELP</button>
        <button id="clearBtn" class="btn ghost" type="button">CLEAR</button>

        <!-- ‚úÖ ID matches your current app.js -->
        <button id="toNewestBtn" class="btn ghost small" type="button" title="Scroll terminal to newest">
          ‚Üë NEWEST
        </button>
      </div>

      <div class="status-row">
        <div id="status" class="status" aria-live="polite"></div>
        <div class="live"><span class="pulse"></span> LIVE</div>
      </div>

      <div class="stream-wrap">
        <!-- this floating button is optional; app.js uses toNewestBtn -->
        <button
          id="streamTopBtn"
          class="stream-top-btn"
          type="button"
          aria-label="Scroll to newest"
          onclick="document.getElementById('toNewestBtn')?.click()"
        >
          ‚Üë NEWEST
        </button>

        <div class="stream" id="voidStream" aria-live="polite"></div>
      </div>

      <footer class="footer">
        <div class="tiny">‚ö†Ô∏è Puzzle vault. Don‚Äôt use for harm.</div>
        <div class="tiny muted">¬© MyrqAI</div>
      </footer>
    </section>

    <!-- Onboarding modal -->
    <div id="onboarding" class="modal" aria-hidden="true">
      <div class="modal-card" role="dialog" aria-modal="true" aria-label="How it works">
        <div class="modal-title">The Myrq Protocol</div>
        <div class="modal-text">
          <p><b>Loop:</b> Scan ‚Üí Click Signal ‚Üí Synthesize ‚Üí Solve ‚Üí Unlock.</p>
          <p><b>Progress:</b> Synchronicity reads URL flags like <code>solved_0x100=1</code>.</p>
          <p class="muted tiny">Auto-closes in <span id="obTimer">10</span>s.</p>
        </div>
        <div class="modal-actions">
          <button id="closeOnboarding" class="btn primary" type="button">ENTER TERMINAL</button>
        </div>
      </div>
    </div>

    <!-- Puzzle modal -->
    <div id="puzzleModal" class="modal" aria-hidden="true">
      <div class="modal-card" role="dialog" aria-modal="true" aria-label="Puzzle">
        <div class="modal-title" id="puzTitle">Signal</div>

        <div class="modal-text">
          <div class="tiny muted" id="puzMeta"></div>
          <p id="puzPrompt"></p>

          <!-- Keep for debugging; you can hide in CSS if you want -->
          <textarea id="puzPayload" class="ta" rows="3" readonly spellcheck="false"></textarea>

          <input id="puzAnswer" class="pw" placeholder="enter answer" autocomplete="off" spellcheck="false" />
        </div>

        <div class="modal-actions">
          <button id="puzSolve" class="btn primary" type="button">SOLVE</button>
          <button id="puzClose" class="btn ghost" type="button">CLOSE</button>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Because you open /void/void.html, the JSON must be under /void/
    window.__PUZZLES_URL__ = "./puzzles.master.json";

    window.__API_BASE__ = window.__API_BASE__ || "";
    window.__GEMINI_API_KEY__ = window.__GEMINI_API_KEY__ || "";
    window.__DAILY_PULSE__ = (typeof window.__DAILY_PULSE__ === "boolean") ? window.__DAILY_PULSE__ : false;
  </script>

  <script type="module" src="./app.js"></script>
</body>
</html>